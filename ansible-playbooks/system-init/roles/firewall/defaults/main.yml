---
# 防火墙角色默认变量
# 提供防火墙配置的默认设置

# 防火墙功能开关
firewall_enabled: true

# 防火墙备用方案开关
firewall_fallback_enabled: false

# 防火墙日志开关
firewall_logging_enabled: true

# 防火墙监控开关
firewall_monitoring_enabled: true

# 防火墙服务列表
firewall_services:
  - ssh
  - http
  - https

# 防火墙富规则 (firewalld)
firewall_rich_rules:
  - "rule family='ipv4' source address='192.168.1.0/24' accept"
  - "rule service name='ssh' log prefix='ssh ' level='notice' limit value='1/m' accept"

# iptables 规则 (备用方案)
iptables_rules:
  - chain: INPUT
    rule: "-p tcp --dport 22 -j ACCEPT"
    action: append
  - chain: INPUT
    rule: "-p tcp --dport 80 -j ACCEPT"
    action: append
  - chain: INPUT
    rule: "-p tcp --dport 443 -j ACCEPT"
    action: append
  - chain: INPUT
    rule: "-j DROP"
    action: append

# 防火墙日志规则
firewall_log_rules:
  - log_prefix: "firewalld: "
    log_level: "info"

# 防火墙日志级别 (UFW)
firewall_log_level: "on"

# 防火墙监控配置
firewall_monitor_interval: 5  # 分钟

# 网络接口防火墙规则
interface_firewall_rules:
  - interface: "eth0"
    zone: "public"
    trusted: false
  - interface: "lo"
    zone: "trusted"
    trusted: true

# IP 地址白名单
firewall_whitelist:
  - "192.168.1.0/24"
  - "10.0.0.0/8"

# IP 地址黑名单
firewall_blacklist:
  - "192.168.1.100"
  - "10.0.0.50"

# 端口转发规则
port_forwarding_rules:
  - dport: 80
    protocol: tcp
    to_port: 8080
    to_addr: "192.168.1.10"

# 防火墙高级配置
firewall_advanced_config:
  enable_masquerade: false
  enable_icmp_blocking: false
  enable_direct_rules: false

# 防火墙性能优化
firewall_performance:
  connection_tracking: true
  syn_cookies: true
  log_martians: true

# 防火墙安全策略
firewall_security_policies:
  default_input_policy: "deny"
  default_output_policy: "allow"
  default_forward_policy: "deny"
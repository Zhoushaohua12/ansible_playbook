# Git ä»“åº“ç®¡ç†ç¤ºä¾‹å˜é‡é…ç½®

# éƒ¨ç½²ç¯å¢ƒé…ç½®
deploy_environment: "development"  # development, staging, production
app_user: "deploy"
app_group: "deploy"
app_base_path: "/opt"

# Git SSH è®¤è¯é…ç½®
git_ssh_key_path: "/home/deploy/.ssh/deploy_key"  # éƒ¨ç½²å¯†é’¥è·¯å¾„

# ä¸»åº”ç”¨ä»“åº“é…ç½®
main_app_repo: "git@github.com:company/web-application.git"
main_app_path: "{{ app_base_path }}/webapp"
main_app_branch: "develop"
deploy_main_app: true

# ç”Ÿäº§ç¯å¢ƒåº”ç”¨é…ç½®
production_app_repo: "git@github.com:company/production-app.git"
production_app_path: "{{ app_base_path }}/production-app"
production_app_tag: "v2.1.0"  # ç”Ÿäº§ç¯å¢ƒä½¿ç”¨æ ‡ç­¾ç‰ˆæœ¬
deploy_production_app: false

# é…ç½®ä»“åº“é…ç½®
config_repo: "git@github.com:company/app-config.git"
config_path: "{{ app_base_path }}/config"
config_branch: "main"
deploy_config: true

# é™æ€èµ„æºä»“åº“é…ç½®
assets_repo: "https://github.com/company/static-assets.git"
assets_path: "{{ app_base_path }}/assets"
assets_version: "v1.5.2"
deploy_assets: true

# å¤æ‚åº”ç”¨ä»“åº“ï¼ˆåŒ…å«å­æ¨¡å—ï¼‰
complex_app_repo: "git@github.com:company/complex-service.git"
complex_app_path: "{{ app_base_path }}/complex-service"
complex_app_version: "feature/new-api"
deploy_complex_app: false

# åº”ç”¨é…ç½®æ–‡ä»¶åˆ—è¡¨
config_files:
  - "database.yml"
  - "redis.yml"
  - "logging.yml"
  - "secrets.yml"

# æ„å»ºå’Œå®‰è£…é…ç½®
install_dependencies: true
install_command: "npm install --production"
build_application: true
build_command: "npm run build"

# æœåŠ¡ç®¡ç†é…ç½®
manage_app_service: true
app_service_name: "webapp"
manage_web_server: true
web_server_name: "nginx"

# Git æ“ä½œé€‰é¡¹
git_force_update: true
git_accept_hostkey: true
git_clone_depth: 1  # æµ…å…‹éš†æ·±åº¦ï¼Œ0 è¡¨ç¤ºå®Œæ•´å…‹éš†

# éƒ¨ç½²ç­–ç•¥é…ç½®
enable_rollback: true
backup_before_deploy: true
max_backup_versions: 5

# é‡è¦ï¼šè¿™äº›å˜é‡ä»…ç”¨äºæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ Ansible Vault æˆ–å¤–éƒ¨é…ç½®ç®¡ç†
# âš ï¸ è­¦å‘Šï¼šGit ä»“åº“ URL å’Œ SSH å¯†é’¥è·¯å¾„éœ€è¦æ ¹æ®å®é™…ç¯å¢ƒé…ç½®
# ğŸ”’ å®‰å…¨æç¤ºï¼šç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨å—ä¿æŠ¤çš„éƒ¨ç½²å¯†é’¥ï¼Œå¹¶å®šæœŸè½®æ¢
# ğŸ“ æ³¨æ„ï¼šç¡®ä¿éƒ¨ç½²ç”¨æˆ·å¯¹ç›®æ ‡ç›®å½•æœ‰å†™æƒé™ï¼ŒSSH å¯†é’¥æ–‡ä»¶æƒé™ä¸º 600

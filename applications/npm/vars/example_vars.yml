# Node.js åŒ…ç®¡ç†ç¤ºä¾‹å˜é‡é…ç½®

# ç³»ç»Ÿé…ç½®
install_system_nodejs: true  # æ˜¯å¦å®‰è£…ç³»ç»Ÿçº§ Node.js å’Œ npm

# å…¨å±€ CLI å·¥å…·
global_cli_tools:
  - "pm2@5.3.0"
  - "nodemon@3.0.1"
  - "typescript@5.2.2"
  - "@vue/cli@5.0.8"
  - "create-react-app@5.0.1"
install_global_tools: true  # æ˜¯å¦å®‰è£…å…¨å±€å·¥å…·

# åº”ç”¨è·¯å¾„é…ç½®
app_path: "/opt/nodejs-app"  # Node.js åº”ç”¨è·¯å¾„
app_user: "nodeuser"  # åº”ç”¨è¿è¡Œç”¨æˆ·
app_group: "nodegroup"  # åº”ç”¨è¿è¡Œç»„
create_app_dir: true  # æ˜¯å¦åˆ›å»ºåº”ç”¨ç›®å½•

# package.json é…ç½®
create_package_json: true  # æ˜¯å¦åˆ›å»º package.json æ–‡ä»¶
package_json_exists: true  # package.json æ˜¯å¦å­˜åœ¨ï¼ˆç”¨äºæ¡ä»¶åˆ¤æ–­ï¼‰

# æ ¸å¿ƒä¾èµ–åŒ…
core_dependencies:
  - "express@4.18.2"
  - "cors@2.8.5"
  - "helmet@7.0.0"
  - "morgan@1.10.0"
  - "dotenv@16.3.1"
  - "bcryptjs@2.4.3"
  - "jsonwebtoken@9.0.2"
install_core_deps: true  # æ˜¯å¦å®‰è£…æ ¸å¿ƒä¾èµ–

# å¼€å‘ä¾èµ–åŒ…
development_dependencies:
  - "nodemon@3.0.1"
  - "jest@29.7.0"
  - "eslint@8.50.0"
  - "prettier@3.0.3"
  - "supertest@6.3.3"
  - "@types/node@20.6.3"
install_dev_deps: true  # æ˜¯å¦å®‰è£…å¼€å‘ä¾èµ–

# npm æ³¨å†Œè¡¨é…ç½®
npm_registry: "https://registry.npmjs.org/"  # npm æ³¨å†Œè¡¨åœ°å€
install_from_package: true  # æ˜¯å¦ä» package.json å®‰è£…
install_production_only: false  # æ˜¯å¦åªå®‰è£…ç”Ÿäº§ä¾èµ–

# Git ä»“åº“åŒ…
git_packages:
  - "git+https://github.com/user/custom-lib.git#v2.1.0"
  - "git+https://github.com/another-org/utils.git#main"
install_git_packages: false  # æ˜¯å¦å®‰è£… Git ä»“åº“åŒ…

# å®‰å…¨ç›¸å…³åŒ…ï¼ˆéœ€è¦ä¿æŒæœ€æ–°ï¼‰
security_packages:
  - "lodash"
  - "request"
  - "moment"
  - "axios"
upgrade_security_packages: true  # æ˜¯å¦å‡çº§å®‰å…¨åŒ…

# æ¸…ç†åŒ…åˆ—è¡¨
cleanup_packages:
  - "debug"
  - "chalk"
  - "ora"
cleanup_dev_packages: false  # æ˜¯å¦æ¸…ç†å¼€å‘åŒ…

# å®‰å…¨å®¡è®¡é…ç½®
run_npm_audit: true  # æ˜¯å¦è¿è¡Œ npm audit
run_npm_audit_fix: true  # æ˜¯å¦è‡ªåŠ¨ä¿®å¤å®‰å…¨æ¼æ´

# åº”ç”¨æ„å»ºé…ç½®
build_app: true  # æ˜¯å¦æ„å»ºåº”ç”¨
create_start_script: true  # æ˜¯å¦åˆ›å»ºå¯åŠ¨è„šæœ¬
set_permissions: true  # æ˜¯å¦è®¾ç½®ç›®å½•æƒé™

# æœåŠ¡é…ç½®
app_service_name: "nodejs-app"  # systemd æœåŠ¡åç§°

# æ˜¾ç¤ºé…ç½®
show_results: true  # æ˜¯å¦æ˜¾ç¤ºæ“ä½œç»“æœæ‘˜è¦
verify_installation: true  # æ˜¯å¦éªŒè¯å®‰è£…ç»“æœ

# åº”ç”¨ä¿¡æ¯
app_name: "Node.js Web Application"
app_version: "1.0.0"
app_description: "åŸºäº Express çš„ Web åº”ç”¨"
app_author: "DevOps Team"

# é‡è¦ï¼šè¿™äº›å˜é‡ä»…ç”¨äºæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ Ansible Vault æˆ–å¤–éƒ¨é…ç½®ç®¡ç†
# âš ï¸ è­¦å‘Šï¼šåŒ…ç‰ˆæœ¬éœ€è¦æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ï¼Œå»ºè®®å›ºå®šç‰ˆæœ¬å·
# ğŸ”’ å®‰å…¨æç¤ºï¼šä½¿ç”¨å¯ä¿¡çš„ npm æ³¨å†Œè¡¨ï¼Œé¿å…å®‰è£…æ¶æ„åŒ…
# ğŸ“ æ³¨æ„ï¼šåº”ç”¨è·¯å¾„éœ€è¦æ ¹æ®å®é™…éƒ¨ç½²ç¯å¢ƒè°ƒæ•´
# ğŸš€ æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ä¼ä¸šå†…éƒ¨ npm é•œåƒå¯ä»¥åŠ é€ŸåŒ…ä¸‹è½½
# ğŸ” å®‰å…¨å®¡è®¡ï¼šå»ºè®®å®šæœŸè¿è¡Œ npm audit æ£€æŸ¥å®‰å…¨æ¼æ´
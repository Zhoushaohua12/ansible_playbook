---
# PostgreSQL 连接配置
postgres_host: "db.example.com"  # PostgreSQL 服务器地址
postgres_port: 5432  # PostgreSQL 服务器端口
postgres_admin_user: "postgres"  # 管理员用户名，需要 CREATEDB 权限
postgres_admin_password: "PLEASE_CHANGE_THIS_ADMIN_PASSWORD"  # ⚠️ 管理员密码 - 生产环境请使用 ansible-vault 加密

# 数据库配置
app_database_name: "webapp_db"  # 应用数据库名称
app_database_owner: "webapp_user"  # 数据库所有者用户名
db_encoding: "UTF8"  # 数据库字符编码，推荐使用 UTF8
db_lc_collate: "en_US.UTF-8"  # 排序规则，影响字符串比较和排序
db_lc_ctype: "en_US.UTF-8"  # 字符分类，影响字符类型判断
db_template: "template0"  # 数据库模板，template0 用于自定义 encoding 和 locale

# 多租户数据库配置
create_tenant_databases: false  # 是否创建多租户数据库
tenant_databases:  # 租户数据库列表
  - name: "tenant_a_db"
    owner: "tenant_a_user"
    conn_limit: 50  # 最大连接数限制
  - name: "tenant_b_db"
    owner: "tenant_b_user"
    conn_limit: 30
  - name: "tenant_c_db"
    owner: "tenant_c_user"
    conn_limit: 100

# 日志数据库配置
log_database_name: "app_logs"  # 日志数据库名称
log_database_owner: "log_writer_user"  # 日志数据库所有者

# 测试数据库配置
create_test_database: false  # 是否创建测试数据库
test_database_name: "test_webapp_db"  # 测试数据库名称

# 备份配置
backup_directory: "/var/backups/postgresql"  # 备份文件存储目录
perform_backup: false  # 是否执行备份，设为 true 时导出数据库

# 恢复配置
perform_restore: false  # 是否执行恢复操作
restore_database_name: "webapp_db_restored"  # 恢复后的数据库名称
restore_file_path: "/var/backups/postgresql/webapp_db_20231201.dump"  # 备份文件路径

# 开发环境配置
create_dev_database: false  # 是否创建开发环境数据库
dev_database_name: "dev_webapp_db"  # 开发数据库名称
dev_database_owner: "dev_user"  # 开发数据库所有者
production_database_template: "webapp_db"  # 生产数据库模板（用于克隆结构）

# 清理配置
cleanup_deprecated_databases: false  # 是否清理废弃数据库，谨慎操作
deprecated_databases:  # 待删除的数据库列表
  - "old_test_db"
  - "deprecated_webapp_db_v1"

# ⚠️ 安全提示：
# 1. 管理员密码字段是占位符，请替换为真实密码
# 2. 生产环境务必使用 ansible-vault encrypt 加密此文件
# 3. 删除数据库前务必先执行备份操作
# 4. 确保 pg_hba.conf 配置允许 Ansible 主机连接
# 5. 备份目录需要足够的磁盘空间
# 6. lc_collate 和 lc_ctype 需要在操作系统层面已安装对应的 locale
# 7. 数据库 owner 用户必须已经存在，可使用 community.postgresql.postgresql_user 模块创建

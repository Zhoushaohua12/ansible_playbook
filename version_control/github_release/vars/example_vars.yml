# GitHub Release ç®¡ç†ç¤ºä¾‹å˜é‡é…ç½®

# GitHub è®¤è¯é…ç½®
github_user: "myorg"  # GitHub ç”¨æˆ·åæˆ–ç»„ç»‡å
github_repo: "awesome-app"  # GitHub ä»“åº“åç§°
github_token: "ghp_xxxxxxxxxxxxxxxxxxxx"  # GitHub Personal Access Tokenï¼ˆç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ Ansible Vaultï¼‰

# åº”ç”¨ä¿¡æ¯
app_name: "awesome-app"  # åº”ç”¨åç§°
app_version: "2.1.3"  # å½“å‰ç‰ˆæœ¬
next_version: "2.2.0"  # ä¸‹ä¸€ä¸ªç‰ˆæœ¬

# æ„å»ºé…ç½®
build_path: "/tmp/github-release-build"  # æ„å»ºç›®å½•è·¯å¾„
create_build_dir: true  # æ˜¯å¦åˆ›å»ºæ„å»ºç›®å½•
prepare_binaries: true  # æ˜¯å¦å‡†å¤‡äºŒè¿›åˆ¶æ–‡ä»¶
create_archives: true  # æ˜¯å¦åˆ›å»ºå‹ç¼©åŒ…
prepare_windows_binaries: true  # æ˜¯å¦å‡†å¤‡ Windows äºŒè¿›åˆ¶æ–‡ä»¶
generate_checksums: true  # æ˜¯å¦ç”Ÿæˆæ ¡éªŒå’Œæ–‡ä»¶

# å¹³å°é…ç½®
platforms:
  - platform: "linux"
    arch: "amd64"
  - platform: "linux"
    arch: "arm64"
  - platform: "darwin"
    arch: "amd64"
  - platform: "darwin"
    arch: "arm64"

windows_archs:
  - arch: "amd64"
  - arch: "386"

# Release é…ç½®
create_production_release: true  # æ˜¯å¦åˆ›å»ºç”Ÿäº§ç¯å¢ƒ Release
upload_production_files: true  # æ˜¯å¦ä¸Šä¼ ç”Ÿäº§ç¯å¢ƒæ–‡ä»¶
create_rc_release: true  # æ˜¯å¦åˆ›å»ºé¢„å‘å¸ƒ Release
upload_rc_files: true  # æ˜¯å¦ä¸Šä¼ é¢„å‘å¸ƒæ–‡ä»¶
create_draft_release: true  # æ˜¯å¦åˆ›å»ºè‰ç¨¿ Release

# æäº¤é…ç½®
target_commit: "main"  # ç”Ÿäº§ç¯å¢ƒç›®æ ‡æäº¤
rc_target_commit: "develop"  # é¢„å‘å¸ƒç¯å¢ƒç›®æ ‡æäº¤

# Release Notes é…ç½®
release_notes_body: |
  # Release v{{ app_version }}
  
  ## ğŸš€ æ–°åŠŸèƒ½
  - æ·»åŠ äº†ç”¨æˆ·è®¤è¯åŠŸèƒ½
  - ä¼˜åŒ–äº† API å“åº”æ€§èƒ½
  - æ–°å¢äº†æ•°æ®å¯¼å‡ºåŠŸèƒ½
  
  ## ğŸ› é—®é¢˜ä¿®å¤
  - ä¿®å¤äº†å†…å­˜æ³„æ¼é—®é¢˜
  - è§£å†³äº†å¹¶å‘è®¿é—®çš„ç«æ€æ¡ä»¶
  - ä¿®å¤äº† UI æ˜¾ç¤ºå¼‚å¸¸
  
  ## ğŸ”§ æ”¹è¿›
  - é‡æ„äº†ä»£ç æ¶æ„
  - ä¼˜åŒ–äº†æ•°æ®åº“æŸ¥è¯¢
  - æ”¹è¿›äº†é”™è¯¯å¤„ç†æœºåˆ¶
  
  ## ğŸ“¦ ä¾èµ–æ›´æ–°
  - å‡çº§äº† Spring Boot åˆ° 2.7.x
  - æ›´æ–°äº†å®‰å…¨ä¾èµ–åŒ…
  - å‡çº§äº†æ•°æ®åº“é©±åŠ¨
  
  ## ğŸ“‹ å®‰è£…è¯´æ˜
  ```bash
  # ä¸‹è½½å¯¹åº”å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶
  wget https://github.com/{{ github_user }}/{{ github_repo }}/releases/download/v{{ app_version }}/{{ app_name }}-{{ app_version }}-linux-amd64.tar.gz
  
  # è§£å‹å¹¶è¿è¡Œ
  tar -xzf {{ app_name }}-{{ app_version }}-linux-amd64.tar.gz
  ./{{ app_name }}-{{ app_version }}-linux-amd64/{{ app_name }}
  ```
  
  ## ğŸ” æ ¡éªŒå’Œ
  è¯·ä½¿ç”¨æä¾›çš„æ ¡éªŒå’Œæ–‡ä»¶éªŒè¯æ–‡ä»¶å®Œæ•´æ€§ï¼š
  ```bash
  sha256sum -c {{ app_name }}-{{ app_version }}-sha256sum.txt
  ```

rc_release_notes_body: |
  # Release Candidate v{{ app_version }}-rc.1
  
  ## ğŸ§ª æµ‹è¯•ç‰ˆæœ¬
  è¿™æ˜¯ä¸€ä¸ªå€™é€‰å‘å¸ƒç‰ˆæœ¬ï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
  
  - æ–°çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
  - æ€§èƒ½ä¼˜åŒ–æ”¹è¿›
  - å®‰å…¨æ€§å¢å¼º
  
  ## âš ï¸ æ³¨æ„äº‹é¡¹
  - æ­¤ç‰ˆæœ¬ä»…ç”¨äºæµ‹è¯•ï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨
  - è¯·åœ¨æµ‹è¯•ç¯å¢ƒå……åˆ†éªŒè¯åå†å‡çº§
  - å‘ç°é—®é¢˜è¯·åŠæ—¶åé¦ˆ
  
  ## ğŸ“‹ æµ‹è¯•æŒ‡å—
  1. å¤‡ä»½ç°æœ‰æ•°æ®
  2. åœ¨æµ‹è¯•ç¯å¢ƒéƒ¨ç½²æ­¤ç‰ˆæœ¬
  3. éªŒè¯æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸
  4. æ£€æŸ¥æ€§èƒ½å’Œç¨³å®šæ€§
  5. æŠ¥å‘Šå‘ç°çš„é—®é¢˜

draft_release_notes_body: |
  # Draft Release v{{ next_version }}
  
  ## ğŸ“ è®¡åˆ’åŠŸèƒ½
  - [ ] æ–°åŠŸèƒ½ A
  - [ ] æ–°åŠŸèƒ½ B
  - [ ] æ€§èƒ½ä¼˜åŒ–
  - [ ] å®‰å…¨æ”¹è¿›
  
  ## ğŸ”§ å¼€å‘è¿›åº¦
  - åŠŸèƒ½ Aï¼šè¿›è¡Œä¸­ (80%)
  - åŠŸèƒ½ Bï¼šæœªå¼€å§‹ (0%)
  - æ–‡æ¡£æ›´æ–°ï¼šå¾…å¼€å§‹
  
  ## ğŸ“… å‘å¸ƒè®¡åˆ’
  - é¢„è®¡å‘å¸ƒæ—¶é—´ï¼š{{ (ansible_date_time.iso8601 | regex_replace('T.*', '')) | to_datetime('%Y-%m-%d') + timedelta(days=14) }}
  - æµ‹è¯•å¼€å§‹ï¼š{{ (ansible_date_time.iso8601 | regex_replace('T.*', '')) | to_datetime('%Y-%m-%d') + timedelta(days=7) }}

# æ–‡ä»¶åˆ—è¡¨é…ç½®
production_files:
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-linux-amd64.tar.gz"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-linux-arm64.tar.gz"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-darwin-amd64.tar.gz"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-darwin-arm64.tar.gz"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-windows-amd64.exe"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-windows-386.exe"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-sha256sum.txt"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-md5sum.txt"

rc_files:
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-rc.1-linux-amd64.tar.gz"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-rc.1-linux-arm64.tar.gz"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-rc.1-darwin-amd64.tar.gz"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-rc.1-windows-amd64.exe"
  - "{{ build_path }}/{{ app_name }}-{{ app_version }}-rc.1-sha256sum.txt"

# ä¿¡æ¯è·å–é…ç½®
get_latest_release: true  # æ˜¯å¦è·å–æœ€æ–° Release
list_all_releases: true  # æ˜¯å¦åˆ—å‡ºæ‰€æœ‰ Release
verify_uploaded_files: true  # æ˜¯å¦éªŒè¯ä¸Šä¼ æ–‡ä»¶

# æ¸…ç†é…ç½®
cleanup_build_files: true  # æ˜¯å¦æ¸…ç†æ„å»ºæ–‡ä»¶
old_release_tags:  # è¦æ¸…ç†çš„æ—§ Release æ ‡ç­¾
  - "v1.0.0"
  - "v1.0.1"
  - "v1.1.0"

# æ˜¾ç¤ºé…ç½®
show_results: true  # æ˜¯å¦æ˜¾ç¤ºæ“ä½œç»“æœæ‘˜è¦

# åº”ç”¨å…ƒæ•°æ®
app_description: "ä¸€ä¸ªä¼˜ç§€çš„å¼€æºåº”ç”¨"
app_homepage: "https://github.com/{{ github_user }}/{{ github_repo }}"
app_license: "MIT"
app_author: "å¼€å‘å›¢é˜Ÿ"

# å‘å¸ƒç­–ç•¥é…ç½®
release_strategy:
  auto_tag: true  # æ˜¯å¦è‡ªåŠ¨åˆ›å»ºæ ‡ç­¾
  auto_changelog: true  # æ˜¯å¦è‡ªåŠ¨ç”Ÿæˆå˜æ›´æ—¥å¿—
  require_tests: true  # æ˜¯å¦è¦æ±‚æµ‹è¯•é€šè¿‡
  require_review: true  # æ˜¯å¦è¦æ±‚ä»£ç å®¡æŸ¥

# é‡è¦ï¼šè¿™äº›å˜é‡ä»…ç”¨äºæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ Ansible Vault æˆ–å¤–éƒ¨é…ç½®ç®¡ç†
# âš ï¸ è­¦å‘Šï¼šGitHub Token éœ€è¦å®‰å…¨å­˜å‚¨ï¼Œå»ºè®®ä½¿ç”¨ Ansible Vault åŠ å¯†
# ğŸ”’ å®‰å…¨æç¤ºï¼šé™åˆ¶ Token æƒé™èŒƒå›´ï¼Œä»…æˆäºˆå¿…è¦çš„ä»“åº“æƒé™
# ğŸ“ æ³¨æ„ï¼šä»“åº“å’Œç”¨æˆ·åéœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
# ğŸš€ æ€§èƒ½ä¼˜åŒ–ï¼šåˆç†æ§åˆ¶æ–‡ä»¶å¤§å°å’Œä¸Šä¼ é¢‘ç‡
# ğŸ” ç›‘æ§å»ºè®®ï¼šç›‘æ§ Release åˆ›å»ºçš„æˆåŠŸç‡å’Œè€—æ—¶
# ğŸ›¡ï¸ å®‰å…¨åŠ å›ºï¼šå®šæœŸè½®æ¢ GitHub è®¿é—®ä»¤ç‰Œ
# ğŸ“Š å®¹é‡è§„åˆ’ï¼šç›‘æ§ GitHub API è°ƒç”¨é¢‘ç‡é™åˆ¶